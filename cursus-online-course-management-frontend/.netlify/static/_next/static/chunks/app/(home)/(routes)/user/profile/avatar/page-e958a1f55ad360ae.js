(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8798],{80817:function(e,s,a){Promise.resolve().then(a.bind(a,69158))},69158:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return p}});var t=a(57437),l=a(2265),r=a(10209),i=a(2529),d=a(50495),c=a(96273),n=a(18422),o=a(18604),m=a(66648),x=a(20990),u=a(7277),h=a(4002),j=e=>{let{initialData:s,userId:a,onAvatarUpdated:i}=e,[j,v]=(0,l.useState)(!1),g=()=>v(e=>!e),p=async(e,s)=>{try{console.log("Uploading image",e,s),await (0,u.gg)(s);let a=await (0,h.ZP)();localStorage.setItem("userData",JSON.stringify(a)),r.ZP.success("Image uploaded successfully"),g(),i()}catch(e){r.ZP.error(e.message||"Failed to upload image")}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.Toaster,{}),(0,t.jsxs)("div",{className:"mt-6 border bg-slate-100 rounded-md p-4",children:[(0,t.jsxs)("div",{className:"font-medium flex items-center justify-between",children:["Avatar Image",(0,t.jsxs)(d.z,{onClick:g,variant:"ghost",children:[j&&(0,t.jsx)(t.Fragment,{children:"Cancel"}),!j&&!s&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.Z,{className:"h-4 w-4 mr-2"}),"Add image"]}),!j&&s&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.Z,{className:"h-4 w-4 mr-2"}),"Edit image"]})]})]}),!j&&(s?(0,t.jsx)("div",{className:"relative aspect-square mt-2",children:(0,t.jsx)(m.default,{alt:"Upload",fill:!0,className:"object-cover rounded-md",src:s,sizes:"(max-width: 640px) 100vw, 50vw",priority:!0})}):(0,t.jsx)("div",{className:"flex items-center justify-center h-60 bg-slate-200 rounded-md",children:(0,t.jsx)(o.Z,{className:"h-10 w-10 text-slate-500"})})),j&&(0,t.jsxs)("div",{children:[(0,t.jsx)(x.Z,{className:"p-10 my-4 border border-muted-foreground rounded-md",id:a||"",onUpload:p}),(0,t.jsx)("div",{className:"text-xs text-muted-foreground mt-4",children:"4:4 aspect ratio recommended"})]})]})]})},v=a(40840),g=a(51035),p=()=>{let[e,s]=(0,l.useState)(null),[a,d]=(0,l.useState)(null),[c,n]=(0,l.useState)(!0),[o,m]=(0,l.useState)(!0),x=(0,l.useCallback)(async()=>{try{let a=localStorage.getItem("userData");a&&s(JSON.parse(a)),(null==e?void 0:e.avatarImageUrl)?n(!0):n(!1)}catch(e){r.ZP.error(e.message||"Failed to get user")}finally{m(!1)}},[null==e?void 0:e.avatarImageUrl]);return((0,l.useEffect)(()=>{x()},[x]),o)?(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("div",{className:"flex flex-col items-center justify-center h-screen",children:(0,t.jsx)(v.Z,{})})}):(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)(r.Toaster,{}),(0,t.jsx)("div",{className:"rounded-[0.5rem] border bg-background shadow",children:(0,t.jsxs)("div",{className:"space-y-6 p-10 pb-16",children:[(0,t.jsx)(g.Z,{}),(0,t.jsx)("div",{className:"shrink-0 bg-border h-[1px] w-full my-6"}),(0,t.jsxs)("div",{className:"flex flex-col space-y-8 lg:flex-row lg:space-x-12 lg:space-y-0",children:[(0,t.jsx)("aside",{className:"-mx-4 lg:w-1/5",children:(0,t.jsx)(i.Z,{})}),(0,t.jsx)("div",{className:"flex-1 lg:max-w-2xl",children:(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-medium",children:"Upload Avatar"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Upload your account avater."})]}),(0,t.jsx)("div",{className:"shrink-0 bg-border h-[1px] w-full my-6"}),c?(0,t.jsx)(j,{initialData:null==e?void 0:e.avatarImageUrl,userId:null==e?void 0:e.uid,onAvatarUpdated:x}):(0,t.jsx)(j,{initialData:null==a?void 0:a.avatarImageUrl,userId:null==a?void 0:a.userId,onAvatarUpdated:x})]})})]})]})})]})})}},20990:function(e,s,a){"use strict";var t=a(57437),l=a(74697),r=a(66648),i=a(2265),d=a(38746),c=a(50495);s.Z=e=>{let{className:s,id:a,onUpload:n}=e,[o,m]=(0,i.useState)([]),x=(0,i.useCallback)(e=>{(null==e?void 0:e.length)&&m(s=>[...s,...e].map(e=>Object.assign(e,{preview:URL.createObjectURL(e),isVideo:e.type.startsWith("video/")})))},[]),u=()=>{o.forEach(e=>{n(a,e)}),m([])},{getRootProps:h,getInputProps:j,isDragActive:v}=(0,d.uI)({onDrop:x,multiple:!1}),g=e=>{m(s=>s.filter(s=>s.name!==e))};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{...h(),className:s,children:[(0,t.jsx)("input",{...j()}),v?(0,t.jsx)("p",{children:"Drop the files here ..."}):(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Drag and drop some files here, or click to select files"})]}),(0,t.jsx)("ul",{children:o.map(e=>(0,t.jsxs)("li",{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsxs)(c.z,{type:"button",title:"Remove file",onClick:()=>g(e.name),variant:"ghost",className:"top-0 right-0 flex",children:[(0,t.jsx)(l.Z,{className:"h-4 w-4"}),(0,t.jsx)("p",{children:"Remove"})]}),(0,t.jsx)(c.z,{onClick:u,disabled:!o.length,children:"Upload"})]}),e.type.startsWith("video/")?(0,t.jsx)("video",{src:e.preview,width:e.size,height:e.size,className:"video-preview",controls:!0,onLoadedData:()=>URL.revokeObjectURL(e.preview)}):e.type.startsWith("image/")&&e.size<5e6?(0,t.jsx)(r.default,{src:e.preview,alt:e.name,width:e.size,height:e.size,style:{objectFit:"cover"},onLoad:()=>URL.revokeObjectURL(e.preview)}):(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:[e.name," - File type not supported or file size is too large"]}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:e.name})]},e.name))})]})}}},function(e){e.O(0,[5508,6018,4810,209,7774,6648,4684,5635,2536,2971,7023,1744],function(){return e(e.s=80817)}),_N_E=e.O()}]);