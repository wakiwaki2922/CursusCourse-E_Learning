(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[502],{59125:function(e,t,s){Promise.resolve().then(s.bind(s,8148))},52432:function(e,t,s){"use strict";s.d(t,{A:function(){return d},P6:function(){return o},Xg:function(){return l},Xh:function(){return n},tu:function(){return i}});var r=s(49894),a=s(1398);let o=async e=>{if((0,r.yn)())throw Error("You are not allowed to create course");try{let t=await a.Z.post("/api/courses/auth/createCourse",e);return console.log("Create course response",t.data),t.data}catch(e){if(console.error("[ACTIONS_CREATE_COURSE]",e),e.response&&e.response.data)throw Error(e.response.data.message||"Fail to create course");throw Error(e.message||"Fail to create course")}},n=async e=>{try{let t=await a.Z.get("/api/courses/getCourseById/".concat(e));return console.log("Get course by id response",t.data),t.data}catch(e){if(console.error("[ACTIONS_GET_COURSE_BY_ID]",e),e.response&&e.response.data)throw Error(e.response.data.message||"Something went wrong!");throw Error(e.message||"Something went wrong!")}},i=async(e,t)=>{if((0,r.yn)())throw Error("You are not allowed to edit course");try{let s=await a.Z.put("/api/courses/auth/updateCourse/".concat(e),t);return console.log("Update response",s.data),s.data}catch(e){if(console.error("[ACTIONS_EDIT_COURSE]",e),e.response&&e.response.data)throw Error(e.response.data.message||"Something went wrong!");throw Error(e.message||"Something went wrong!")}},l=async(e,t)=>{if((0,r.yn)())throw Error("You are not allowed to upload course thumbnail");try{let s=new FormData;s.append("file",t);let r=await a.Z.put("/api/courses/auth/uploadThumbnail/".concat(e),s);return console.log("Upload response",r.data),r.data}catch(e){if(console.error("[ACTIONS_UPLOAD_THUMBNAIL]",e),e.response&&e.response.data)throw Error(e.response.data.message||"Something went wrong!");throw Error(e.message||"Something went wrong!")}},d=async e=>{if((0,r.yn)())throw Error("You are not allowed to delete course");try{let t=await a.Z.delete("/api/courses/auth/deleteCourse/".concat(e));return console.log("Delete response",t.data),t.data}catch(e){if(console.error("[ACTIONS_DELETE_COURSE]",e),e.response&&e.response.data)throw Error(e.response.data.message||"Fail to delete course");throw Error(e.message||"Fail to delete course")}}},19798:function(e,t,s){"use strict";s.d(t,{B$:function(){return i},D$:function(){return l},Kz:function(){return m},PI:function(){return x},Uf:function(){return a},V3:function(){return n},Yt:function(){return d},n6:function(){return o},tG:function(){return u},xb:function(){return c}});var r=s(1398);let a=async()=>{try{return(await r.Z.get("/api/courses/auth/getCoursesOfInstructor")).data}catch(e){return console.log("[ACTIONS_GET_COURSES_OF_INSTRUCTOR]",e),[]}},o=async e=>{try{return(await r.Z.get("/api/courses/auth/getCoursesOfInstructorById",{params:{userId:e}})).data}catch(e){return console.log("[ACTIONS_GET_COURSES_OF_INSTRUCTOR]",e),[]}},n=async()=>{try{return(await r.Z.get("/api/courses/getAllCourses")).data}catch(e){return console.log("[ACTIONS_GET_ALL_COURSES]",e),[]}},i=async(e,t)=>{try{return(await r.Z.get("/api/courses/searchCourses",{params:{title:e,categoryId:t}})).data}catch(e){return console.log("[ACTIONS_SEARCH_COURSES]",e),[]}},l=async()=>{try{return(await r.Z.get("/api/courses/getPublishedCourses")).data}catch(e){return console.log("[ACTIONS_GET_ALL_COURSES]",e),[]}},d=async e=>{try{let t=await r.Z.get("/api/courses/getCourseById/".concat(e));return console.log("Get course by id response",t.data),t.data}catch(e){if(console.log("[ACTIONS_GET_COURSE_BY_ID]",e),e.response&&e.response.data)throw Error(e.response.data.message||"Something went wrong!");throw Error(e.message||"Something went wrong!")}},c=async e=>{try{let t=(await r.Z.get("/api/courses/getCourseByIdByUser/".concat(e))).data;return console.log("Get course by id response",t),t}catch(e){if(console.log("[ACTIONS_GET_COURSE_BY_ID]",e),e.response&&e.response.data)throw Error(e.response.data.message||"Something went wrong!");throw Error(e.message||"Something went wrong!")}},u=async()=>{try{return(await r.Z.get("/api/category/getAll")).data}catch(e){return console.log("[ACTIONS_GET_ALL_CATEGORIES]",e),[]}},m=async()=>{try{return(await r.Z.get("/api/courses/auth/getStudentOwnedCourses")).data}catch(e){return console.log("[ACTIONS_GET_STUDENT_OWN_COURSES]",e),[]}},x=async e=>{try{return(await r.Z.get("/api/courses/auth/getStudentOwnedCourseWithLessonsAndProgressById/".concat(e))).data}catch(e){return console.log("[ACTIONS_GET_STUDENT_OWN_COURSE_BY_ID]",e),null}}},8148:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return eh}});var r=s(57437),a=s(81836),o=s(95137),n=s(87140),i=s(71995),l=s(44867),d=s(99827),c=s(87138),u=s(16463),m=s(2265),x=s(52432),p=s(45816),h=s(50495),f=s(27744),g=s(90399),j=s(10209),y=e=>{let{disabled:t,courseId:s,courseStatus:a,onCourseUpdated:o}=e,n=(0,u.useRouter)(),[i,l]=(0,m.useState)(!1),d=async()=>{try{l(!0),await (0,x.tu)(s,{courseStatus:!a}),o(),n.refresh()}catch(e){j.ZP.error(e.message||"Something went wrong!")}finally{l(!1)}},c=async()=>{try{l(!0),await (0,x.A)(s),j.ZP.success("Course deleted"),n.refresh(),n.push("/instructor/courses")}catch(e){j.ZP.error(e.message||"Fail to delete course")}finally{l(!1)}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(f.x,{}),(0,r.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,r.jsx)(h.z,{onClick:d,disabled:t||i,variant:"outline",size:"sm",children:a?"Unpublish":"Publish"}),(0,r.jsx)(p.Z,{onConfirm:c,children:(0,r.jsx)(h.z,{disabled:i,size:"sm",children:(0,r.jsx)(g.Z,{})})})]})]})},b=s(12603),v=s(69022),N=s(15221),w=s(18422),S=s(36661),C=s(83102);let I=b.Ry({courseTitle:b.Z_().min(1,{message:"Title is required"})});var E=e=>{let{initialData:t,courseId:s,onCourseUpdated:a}=e,[o,n]=(0,m.useState)(!1),i=()=>n(e=>!e),l=(0,v.cI)({resolver:(0,N.F)(I),defaultValues:t});(0,u.useRouter)();let{isSubmitting:d,isValid:c}=l.formState,p=async e=>{try{console.log(e),await (0,x.tu)(s,e),j.ZP.success("Course updated"),i(),a()}catch(e){j.ZP.error(e.message||"Something went wrong!")}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(j.Toaster,{}),(0,r.jsxs)("div",{className:"mt-6 border bg-slate-100 rounded-md p-4",children:[(0,r.jsxs)("div",{className:"font-medium flex items-center justify-between",children:["Course Title",(0,r.jsx)(h.z,{onClick:i,variant:"ghost",children:o?(0,r.jsx)(r.Fragment,{children:"Cancel"}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(w.Z,{className:"h-4 w-4 mr-2"}),"Edit title"]})})]}),!o&&(0,r.jsx)("p",{className:"text-sm mt-2",children:t.courseTitle}),o&&(0,r.jsx)(S.l0,{...l,children:(0,r.jsxs)("form",{onSubmit:l.handleSubmit(p),className:"space-y-4 mt-4",children:[(0,r.jsx)(S.Wi,{control:l.control,name:"courseTitle",render:e=>{let{field:t}=e;return(0,r.jsxs)(S.xJ,{children:[(0,r.jsx)(S.NI,{children:(0,r.jsx)(C.I,{disabled:d,placeholder:"e.g. 'Advanced web development'",...t})}),(0,r.jsx)(S.zG,{})]})}}),(0,r.jsx)("div",{className:"flex items-center gap-x-2",children:(0,r.jsx)(h.z,{disabled:!c||d,type:"submit",children:"Save"})})]})})]})]})},_=s(37440),T=s(93146);let Z=b.Ry({description:b.Z_().min(1,{message:"Description is required"})});var R=e=>{let{initialData:t,courseId:s,onCourseUpdated:a}=e,[o,n]=(0,m.useState)(!1),i=()=>n(e=>!e),l=(0,v.cI)({resolver:(0,N.F)(Z),defaultValues:{description:(null==t?void 0:t.description)||""}});(0,u.useRouter)();let{isSubmitting:d,isValid:c}=l.formState,p=async e=>{try{console.log(e),await (0,x.tu)(s,e),j.ZP.success("Course updated"),i(),a()}catch(e){j.ZP.error(e.message||"Something went wrong!")}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(j.Toaster,{}),(0,r.jsxs)("div",{className:"mt-6 border bg-slate-100 rounded-md p-4",children:[(0,r.jsxs)("div",{className:"font-medium flex items-center justify-between",children:["Course Description",(0,r.jsx)(h.z,{onClick:i,variant:"ghost",children:o?(0,r.jsx)(r.Fragment,{children:"Cancel"}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(w.Z,{className:"h-4 w-4 mr-2"}),(0,r.jsx)("p",{className:"md:text-wrap",children:"Edit description"})]})})]}),!o&&(0,r.jsx)("p",{className:(0,_.cn)("text-sm mt-2",!t.description&&"text-slate-500 italic"),children:t.description||"No description"}),o&&(0,r.jsx)(S.l0,{...l,children:(0,r.jsxs)("form",{onSubmit:l.handleSubmit(p),className:"space-y-4 mt-4",children:[(0,r.jsx)(S.Wi,{control:l.control,name:"description",render:e=>{let{field:t}=e;return(0,r.jsxs)(S.xJ,{children:[(0,r.jsx)(S.NI,{children:(0,r.jsx)(T.g,{disabled:d,placeholder:"e.g. 'This course is about ...'",...t})}),(0,r.jsx)(S.zG,{})]})}}),(0,r.jsx)("div",{className:"flex items-center gap-x-2",children:(0,r.jsx)(h.z,{disabled:!c||d,type:"submit",children:"Save"})})]})})]})]})},O=s(96273),A=s(18604),U=s(66648),k=s(20990),F=e=>{let{initialData:t,courseId:s,onCourseUpdated:a}=e,[o,n]=(0,m.useState)(!1),i=()=>n(e=>!e),l=async(e,t)=>{try{console.log("Uploading image",e,t),await (0,x.Xg)(e,t),j.ZP.success("Image uploaded successfully"),i(),a()}catch(e){j.ZP.error(e.message||"Failed to upload image")}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(j.Toaster,{}),(0,r.jsxs)("div",{className:"mt-6 border bg-slate-100 rounded-md p-4",children:[(0,r.jsxs)("div",{className:"font-medium flex items-center justify-between",children:["Course Image",(0,r.jsxs)(h.z,{onClick:i,variant:"ghost",children:[o&&(0,r.jsx)(r.Fragment,{children:"Cancel"}),!o&&!t.thumbnailUrl&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(O.Z,{className:"h-4 w-4 mr-2"}),"Add image"]}),!o&&t.thumbnailUrl&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(w.Z,{className:"h-4 w-4 mr-2"}),"Edit image"]})]})]}),!o&&(t.thumbnailUrl?(0,r.jsx)("div",{className:"relative aspect-video mt-2",children:(0,r.jsx)(U.default,{alt:"Upload",fill:!0,className:"object-cover rounded-md",src:t.thumbnailUrl,sizes:"(max-width: 640px) 100vw, 50vw"})}):(0,r.jsx)("div",{className:"flex items-center justify-center h-60 bg-slate-200 rounded-md",children:(0,r.jsx)(A.Z,{className:"h-10 w-10 text-slate-500"})})),o&&(0,r.jsxs)("div",{children:[(0,r.jsx)(k.Z,{className:"p-10 my-4 border border-muted-foreground rounded-md",id:s,onUpload:l}),(0,r.jsx)("div",{className:"text-xs text-muted-foreground mt-4",children:"16:9 aspect ratio recommended"})]})]})]})},D=s(1282),P=s(22468),z=s(94712),Y=s(54817),G=s(78661),V=s(74697);G.fC,G.xz;let B=G.h_;G.x8;let L=m.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(G.aV,{ref:t,className:(0,_.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...a})});L.displayName=G.aV.displayName,m.forwardRef((e,t)=>{let{className:s,children:a,...o}=e;return(0,r.jsxs)(B,{children:[(0,r.jsx)(L,{}),(0,r.jsxs)(G.VY,{ref:t,className:(0,_.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...o,children:[a,(0,r.jsxs)(G.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,r.jsx)(V.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}).displayName=G.VY.displayName,m.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(G.Dx,{ref:t,className:(0,_.cn)("text-lg font-semibold leading-none tracking-tight",s),...a})}).displayName=G.Dx.displayName,m.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(G.dk,{ref:t,className:(0,_.cn)("text-sm text-muted-foreground",s),...a})}).displayName=G.dk.displayName;let M=m.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(z.mY,{ref:t,className:(0,_.cn)("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",s),...a})});M.displayName=z.mY.displayName;let W=m.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsxs)("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[(0,r.jsx)(Y.Z,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),(0,r.jsx)(z.mY.Input,{ref:t,className:(0,_.cn)("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",s),...a})]})});W.displayName=z.mY.Input.displayName,m.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(z.mY.List,{ref:t,className:(0,_.cn)("max-h-[300px] overflow-y-auto overflow-x-hidden",s),...a})}).displayName=z.mY.List.displayName;let J=m.forwardRef((e,t)=>(0,r.jsx)(z.mY.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));J.displayName=z.mY.Empty.displayName;let X=m.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(z.mY.Group,{ref:t,className:(0,_.cn)("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",s),...a})});X.displayName=z.mY.Group.displayName,m.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(z.mY.Separator,{ref:t,className:(0,_.cn)("-mx-1 h-px bg-border",s),...a})}).displayName=z.mY.Separator.displayName;let q=m.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(z.mY.Item,{ref:t,className:(0,_.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",s),...a})});q.displayName=z.mY.Item.displayName;var H=s(19573);let K=m.forwardRef((e,t)=>{var s;let{options:a,value:o,onChange:n}=e,[i,l]=m.useState(!1);return(0,r.jsxs)(H.J2,{open:i,onOpenChange:l,children:[(0,r.jsx)(H.xo,{asChild:!0,children:(0,r.jsxs)(h.z,{variant:"outline",role:"combobox","aria-expanded":i,className:"w-full justify-between",children:[o?null===(s=a.find(e=>e.value===o))||void 0===s?void 0:s.label:"Select option...",(0,r.jsx)(D.Z,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,r.jsx)(H.yk,{className:"w-full p-0",children:(0,r.jsxs)(M,{children:[(0,r.jsx)(W,{placeholder:"Search option..."}),(0,r.jsx)(J,{children:"No option found."}),(0,r.jsx)(X,{children:a&&a.map(e=>(0,r.jsx)(z.e8,{children:(0,r.jsxs)(q,{onSelect:()=>{n(e.value===o?"":e.value),l(!1)},children:[(0,r.jsx)(P.Z,{className:(0,_.cn)("mr-2 h-4 w-4",o===e.value?"opacity-100":"opacity-0")}),e.label]},e.value)},e.value))})]})})]})});K.displayName="Combobox";let $=b.Ry({categoryId:b.Z_().min(1)});var Q=e=>{let{initialData:t,courseId:s,options:a,onCourseUpdated:o}=e,[n,i]=(0,m.useState)(!1),l=()=>i(e=>!e),d=(0,v.cI)({resolver:(0,N.F)($),defaultValues:{categoryId:(null==t?void 0:t.categories)||""}});(0,u.useRouter)();let{isSubmitting:c,isValid:p}=d.formState,f=async e=>{try{let t={...e,categoriesId:[Number(e.categoryId)]};console.log(t),await (0,x.tu)(s,t),j.ZP.success("Course updated"),l(),o()}catch(e){j.ZP.error(e.message||"Something went wrong!")}},g=a.find(e=>{var s;return e.value===(null===(s=t.categories[0])||void 0===s?void 0:s.categoryId.toString())});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(j.Toaster,{}),(0,r.jsxs)("div",{className:"mt-6 border bg-slate-100 rounded-md p-4",children:[(0,r.jsxs)("div",{className:"font-medium flex items-center justify-between",children:["Course Category",(0,r.jsx)(h.z,{onClick:l,variant:"ghost",children:n?(0,r.jsx)(r.Fragment,{children:"Cancel"}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(w.Z,{className:"h-4 w-4 mr-2"}),"Edit category"]})})]}),!n&&(0,r.jsx)("p",{className:(0,_.cn)("text-sm mt-2",!t.categories&&"text-slate-500 italic"),children:(null==g?void 0:g.label)||"No category"}),n&&(0,r.jsx)(S.l0,{...d,children:(0,r.jsxs)("form",{onSubmit:d.handleSubmit(f),className:"space-y-4 mt-4",children:[(0,r.jsx)(S.Wi,{control:d.control,name:"categoryId",render:e=>{let{field:t}=e;return(0,r.jsxs)(S.xJ,{children:[(0,r.jsx)(S.NI,{children:(0,r.jsx)(K,{options:a,...t,onChange:e=>{t.onChange(e),d.trigger("categoryId")}})}),(0,r.jsx)(S.zG,{})]})}}),(0,r.jsx)("div",{className:"flex items-center gap-x-2",children:(0,r.jsx)(h.z,{disabled:!p||c,type:"submit",children:"Save"})})]})})]})]})},ee=s(3274),et=s(3156),es=s(86251),er=s(94693),ea=e=>{let{items:t,onReorder:s,onEdit:a}=e,[o,n]=(0,m.useState)(!1),[i,l]=(0,m.useState)(t);return((0,m.useEffect)(()=>{n(!0)},[]),(0,m.useEffect)(()=>{l(t.sort((e,t)=>e.position-t.position))},[t]),o)?(0,r.jsx)(et.Z5,{onDragEnd:e=>{if(!e.destination)return;let t=Array.from(i),[r]=t.splice(e.source.index,1);t.splice(e.destination.index,0,r);let a=Math.min(e.source.index,e.destination.index),o=Math.max(e.source.index,e.destination.index),n=t.slice(a,o+1);l(t),s(n.map(e=>({lessonId:e.lessonId,position:t.findIndex(t=>t.lessonId===e.lessonId)+1})))},children:(0,r.jsx)(et.bK,{droppableId:"chapters",children:e=>(0,r.jsxs)("div",{...e.droppableProps,ref:e.innerRef,children:[i.map((e,t)=>(0,r.jsx)(et._l,{draggableId:e.lessonId,index:t,children:t=>(0,r.jsxs)("div",{className:(0,_.cn)("flex items-center gap-x-2 bg-slate-200 border text-slate-700 rounded-md mb-4 text-sm",e.isPublished&&"bg-sky-100 border-sky-200 text-sky-700"),ref:t.innerRef,...t.draggableProps,children:[(0,r.jsx)("div",{className:(0,_.cn)("px-2 py-3 border-r border-r-slate-200 hover:bg-slate-300 rounded-l-md transition",e.isPublished&&"border-r-sky-200 hover:bg-sky-200"),...t.dragHandleProps,children:(0,r.jsx)(es.Z,{className:"h-5 w-5"})}),e.lessonTitle,(0,r.jsxs)("div",{className:"ml-auto pr-2 flex items-center gap-x-2",children:[e.isFree&&(0,r.jsx)(er.C,{children:"Free"}),(0,r.jsx)(er.C,{className:(0,_.cn)("bg-slate-500",e.isPublished&&"bg-sky-700"),children:e.isPublished?"Published":"Draft"}),(0,r.jsx)(w.Z,{onClick:()=>a(e.lessonId),className:"w-4 h-4 cursor-pointer hover:opacity-75 transition"})]})]})},e.position)),e.placeholder]})})}):null},eo=s(87292);let en=b.Ry({title:b.Z_().min(1)});var ei=e=>{let{initialData:t,courseId:s,onCourseUpdated:a}=e,[o,n]=(0,m.useState)(!1),[i,l]=(0,m.useState)(!1),d=()=>{n(e=>!e)},c=(0,v.cI)({resolver:(0,N.F)(en),defaultValues:{title:""}}),x=(0,u.useRouter)(),{isSubmitting:p,isValid:f}=c.formState,g=async e=>{try{console.log(e),await (0,eo.aA)(s,e.title),j.ZP.success("Chapter created"),d(),a()}catch(e){j.ZP.error(e.message||"Something went wrong!")}},y=async e=>{try{l(!0),await (0,eo.mt)(s,e),j.ZP.success("Chapters re-ordered"),a()}catch(e){j.ZP.error(e.message||"Something went wrong!")}finally{l(!1)}},b=t.lessons||[];return(0,r.jsxs)("div",{className:"relative mt-6 border bg-slate-100 rounded-md p-4",children:[i&&(0,r.jsx)("div",{className:"absolute h-full w-full bg-slate-500/20 top-0 right-0 rounded-md flex items-center justify-center",children:(0,r.jsx)(ee.Z,{className:"animate-spin h-6 w-6 text-sky-700"})}),(0,r.jsxs)("div",{className:"font-medium flex items-center justify-between",children:["Course Chapters",(0,r.jsx)(h.z,{onClick:d,variant:"ghost",children:o?(0,r.jsx)(r.Fragment,{children:"Cancel"}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(O.Z,{className:"h-4 w-4 mr-2"}),(0,r.jsx)("p",{className:"md:text-wrap",children:"Add chapter video"})]})})]}),o&&(0,r.jsx)(S.l0,{...c,children:(0,r.jsxs)("form",{onSubmit:c.handleSubmit(g),className:"space-y-4 mt-4",children:[(0,r.jsx)(S.Wi,{control:c.control,name:"title",render:e=>{let{field:t}=e;return(0,r.jsxs)(S.xJ,{children:[(0,r.jsx)(S.NI,{children:(0,r.jsx)(C.I,{disabled:p,placeholder:"e.g. 'Introduction to the course'",...t})}),(0,r.jsx)(S.zG,{})]})}}),(0,r.jsx)(h.z,{disabled:!f||p,type:"submit",children:"Create"})]})}),!o&&(0,r.jsxs)("div",{className:(0,_.cn)("text-sm mt-2",!b.length&&"text-slate-500 italic"),children:[!b.length&&"Do not have any chapter on this course",(0,r.jsx)(ea,{onEdit:e=>{x.push("/instructor/courses/".concat(s,"/lessons/").concat(e))},onReorder:y,items:b})]}),!o&&(0,r.jsx)("p",{className:"text-xs text-muted-foreground mt-4",children:"Drag and drop to re-order the chapters"})]})},el=s(77003);let ed=b.Ry({price:b.oQ.number()});var ec=e=>{let{initialData:t,courseId:s,onCourseUpdated:a}=e,[o,n]=(0,m.useState)(!1),i=()=>n(e=>!e),l=(0,v.cI)({resolver:(0,N.F)(ed),defaultValues:{price:(null==t?void 0:t.price)||void 0}});(0,u.useRouter)();let{isSubmitting:d,isValid:c}=l.formState,p=async e=>{try{console.log(e),await (0,x.tu)(s,e),j.ZP.success("Course updated"),i(),a()}catch(e){j.ZP.error(e.message||"Something went wrong!")}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(j.Toaster,{}),(0,r.jsxs)("div",{className:"mt-6 border bg-slate-100 rounded-md p-4",children:[(0,r.jsxs)("div",{className:"font-medium flex items-center justify-between",children:["Course Price",(0,r.jsx)(h.z,{onClick:i,variant:"ghost",children:o?(0,r.jsx)(r.Fragment,{children:"Cancel"}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(w.Z,{className:"h-4 w-4 mr-2"}),"Edit price"]})})]}),!o&&(0,r.jsx)("p",{className:(0,_.cn)("text-sm mt-2",!t.price&&"text-slate-500 italic"),children:t.price?(0,el.T)(t.price):"No price"}),o&&(0,r.jsx)(S.l0,{...l,children:(0,r.jsxs)("form",{onSubmit:l.handleSubmit(p),className:"space-y-4 mt-4",children:[(0,r.jsx)(S.Wi,{control:l.control,name:"price",render:e=>{let{field:t}=e;return(0,r.jsxs)(S.xJ,{children:[(0,r.jsx)(S.NI,{children:(0,r.jsx)(C.I,{type:"number",step:"0.01",disabled:d,placeholder:"Set a price for your course e.g. '8.88'",...t})}),(0,r.jsx)(S.zG,{})]})}}),(0,r.jsx)("div",{className:"flex items-center gap-x-2",children:(0,r.jsx)(h.z,{disabled:!c||d,type:"submit",children:"Save"})})]})})]})]})},eu=s(88052),em=s(19798),ex=s(32161),ep=s(40840),eh=e=>{let{params:t}=e,[s,p]=(0,m.useState)(),[h,f]=(0,m.useState)([]),g=(0,u.useRouter)();(0,m.useEffect)(()=>{if(!ex.w)return(0,u.redirect)("/")},[g]);let j=(0,m.useCallback)(async()=>{try{console.log(t.courseId);let e=await (0,x.Xh)(t.courseId);p(e)}catch(e){console.error("Error fetching course:",e),g.push("/instructor/courses")}},[t.courseId,g]);if((0,m.useEffect)(()=>{j(),(async()=>{try{let e=(await (0,em.tG)()).map(e=>({...e,categoryId:e.categoryId.toString()}));f(e)}catch(e){console.error("Error fetching categories:",e)}})()},[j]),!s)return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",{className:"flex flex-col items-center justify-center h-screen",children:(0,r.jsx)(ep.Z,{})})});let b=[s.courseTitle,s.description,s.thumbnailUrl,s.price,s.categories,!!s.lessons&&s.lessons.some(e=>e.isPublished)];console.log("Required fields: ",b);let v=b.length,N=b.filter(Boolean).length,w="(".concat(N,"/").concat(v,")"),S=b.every(Boolean);return(0,r.jsxs)(r.Fragment,{children:[!s.courseStatus&&(0,r.jsx)(a.j,{label:"This course is unpublished. It will not visible to others."}),(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)(c.default,{href:"/instructor/courses",className:"flex items-center text-sm hover:opacity-75 transition mb-6",children:[(0,r.jsx)(o.Z,{className:"h-4 w-4 mr-2"}),"Back to courses"]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-y-2",children:[(0,r.jsx)("h1",{className:"text-2xl font-medium",children:"Course Setup"}),(0,r.jsxs)("span",{className:"text-sm text-slate-700",children:["Complete all fields ",w]})]}),(0,r.jsx)(y,{disabled:!S,courseId:t.courseId,courseStatus:s.courseStatus,onCourseUpdated:j})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-16",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,r.jsx)(eu.I,{icon:n.Z}),(0,r.jsx)("h2",{className:"text-xl",children:"Customise your course"})]}),(0,r.jsx)(E,{initialData:s,courseId:s.courseId,onCourseUpdated:j}),(0,r.jsx)(R,{initialData:s,courseId:s.courseId,onCourseUpdated:j}),(0,r.jsx)(F,{initialData:s,courseId:s.courseId,onCourseUpdated:j}),(0,r.jsx)(Q,{initialData:s,courseId:s.courseId,options:h.map(e=>({label:e.categoryName,value:e.categoryId})),onCourseUpdated:j})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,r.jsx)(eu.I,{icon:i.Z}),(0,r.jsx)("h2",{className:"text-xl",children:"Course Chapter"})]}),(0,r.jsx)(ei,{initialData:s,courseId:s.courseId,onCourseUpdated:j})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,r.jsx)(eu.I,{icon:l.Z}),(0,r.jsx)("h2",{className:"text-xl",children:"Sell my course"})]}),(0,r.jsx)(ec,{initialData:s,courseId:s.courseId,onCourseUpdated:j})]}),(0,r.jsx)("div",{children:(0,r.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,r.jsx)(eu.I,{icon:d.Z}),(0,r.jsx)("h2",{className:"text-xl",children:"Resources and Attachments"})]})})]})]})]})]})}},94693:function(e,t,s){"use strict";s.d(t,{C:function(){return i}});var r=s(57437);s(2265);var a=s(73969),o=s(37440);let n=(0,a.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:t,variant:s,...a}=e;return(0,r.jsx)("div",{className:(0,o.cn)(n({variant:s}),t),...a})}},19573:function(e,t,s){"use strict";s.d(t,{J2:function(){return i},xo:function(){return l},yk:function(){return d}});var r=s(57437),a=s(2265),o=s(18038),n=s(37440);let i=o.fC,l=o.xz,d=a.forwardRef((e,t)=>{let{className:s,align:a="center",sideOffset:i=4,...l}=e;return(0,r.jsx)(o.h_,{children:(0,r.jsx)(o.VY,{ref:t,align:a,sideOffset:i,className:(0,n.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...l})})});d.displayName=o.VY.displayName},93146:function(e,t,s){"use strict";s.d(t,{g:function(){return n}});var r=s(57437),a=s(2265),o=s(37440);let n=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("textarea",{className:(0,o.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...a})});n.displayName="Textarea"},27744:function(e,t,s){"use strict";s.d(t,{x:function(){return g}});var r=s(57437),a=s(2265),o=s(68723),n=s(73969),i=s(74697),l=s(37440);let d=o.zt,c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(o.l_,{ref:t,className:(0,l.cn)("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",s),...a})});c.displayName=o.l_.displayName;let u=(0,n.j)("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),m=a.forwardRef((e,t)=>{let{className:s,variant:a,...n}=e;return(0,r.jsx)(o.fC,{ref:t,className:(0,l.cn)(u({variant:a}),s),...n})});m.displayName=o.fC.displayName,a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(o.aU,{ref:t,className:(0,l.cn)("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",s),...a})}).displayName=o.aU.displayName;let x=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(o.x8,{ref:t,className:(0,l.cn)("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",s),"toast-close":"",...a,children:(0,r.jsx)(i.Z,{className:"h-4 w-4"})})});x.displayName=o.x8.displayName;let p=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(o.Dx,{ref:t,className:(0,l.cn)("text-sm font-semibold",s),...a})});p.displayName=o.Dx.displayName;let h=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(o.dk,{ref:t,className:(0,l.cn)("text-sm opacity-90",s),...a})});h.displayName=o.dk.displayName;var f=s(95778);function g(){let{toasts:e}=(0,f.pm)();return(0,r.jsxs)(d,{children:[e.map(function(e){let{id:t,title:s,description:a,action:o,...n}=e;return(0,r.jsxs)(m,{...n,children:[(0,r.jsxs)("div",{className:"grid gap-1",children:[s&&(0,r.jsx)(p,{children:s}),a&&(0,r.jsx)(h,{children:a})]}),o,(0,r.jsx)(x,{})]},t)}),(0,r.jsx)(c,{})]})}},95778:function(e,t,s){"use strict";s.d(t,{pm:function(){return m}});var r=s(2265);let a=0,o=new Map,n=e=>{if(o.has(e))return;let t=setTimeout(()=>{o.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);o.set(e,t)},i=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=t;return s?n(s):e.toasts.forEach(e=>{n(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],d={toasts:[]};function c(e){d=i(d,e),l.forEach(e=>{e(d)})}function u(e){let{...t}=e,s=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>c({type:"DISMISS_TOAST",toastId:s});return c({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:e=>{e||r()}}}),{id:s,dismiss:r,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function m(){let[e,t]=r.useState(d);return r.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},77003:function(e,t,s){"use strict";s.d(t,{T:function(){return r}});let r=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e)}},function(e){e.O(0,[3338,5508,6018,4810,209,3671,5192,6765,7138,7774,6648,4684,7346,6025,8385,2971,7023,1744],function(){return e(e.s=59125)}),_N_E=e.O()}]);